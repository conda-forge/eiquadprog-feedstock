From b7ac1a20cfc87e28072651f56b994bdc2c31413f Mon Sep 17 00:00:00 2001
From: Silvio Traversaro <silvio@traversaro.it>
Date: Fri, 12 Sep 2025 14:52:47 +0200
Subject: [PATCH] Only add GCC Clang warnings options in GCC/Clang

---
 tests/CMakeLists.txt | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)

diff --git a/tests/CMakeLists.txt b/tests/CMakeLists.txt
index 52faed7..0b0b12e 100644
--- a/tests/CMakeLists.txt
+++ b/tests/CMakeLists.txt
@@ -24,14 +24,18 @@ set(TESTS eiquadprog-basic eiquadprog-fast eiquadprog-rt eiquadprog-both
 foreach(test ${TESTS})
   add_unit_test(${test} ${test}.cpp)
   target_link_libraries(${test} ${PROJECT_NAME} Boost::unit_test_framework)
-  target_compile_options(
-    ${test} PRIVATE "-Wno-sign-conversion") # We have a lot of implicit size_t
-                                            # to Eigen::Index conversions
+  if(CMAKE_COMPILER_IS_GNUCC OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+    target_compile_options(
+      ${test} PRIVATE "-Wno-sign-conversion") # We have a lot of implicit size_t
+                                              # to Eigen::Index conversions
+  endif()
 endforeach(test ${TESTS})
 
 add_library(testab SHARED TestA.cpp TestB.cpp)
 target_link_libraries(testab ${PROJECT_NAME})
 target_link_libraries(test-integration testab)
-target_compile_options(
-  testab PRIVATE "-Wno-sign-conversion") # We have a lot of implicit size_t to
-                                         # Eigen::Index conversions
+if(CMAKE_COMPILER_IS_GNUCC OR CMAKE_C_COMPILER_ID MATCHES "Clang")
+  target_compile_options(
+    testab PRIVATE "-Wno-sign-conversion") # We have a lot of implicit size_t to
+                                           # Eigen::Index conversions
+endif()

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 6f8d272..043eba4 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -90,8 +90,11 @@ set(${PROJECT_NAME}_HEADERS
     include/${PROJECT_NAME}/eiquadprog-utils.hxx)
 
 add_library(${PROJECT_NAME} src/eiquadprog-fast.cpp src/eiquadprog.cpp)
-target_compile_options(${PROJECT_NAME} PRIVATE "-Wno-sign-conversion"
-)# We have a lot of implicit size_t to Eigen::Index conversions
+
+if(CMAKE_CXX_COMPILER_ID MATCHES "GNU|Clang")
+  # We have a lot of implicit size_t to Eigen::Index conversions
+  target_compile_options(${PROJECT_NAME} PRIVATE "-Wno-sign-conversion")
+endif()
 
 if(TRACE_SOLVER)
   target_compile_definitions(${PROJECT_NAME} PRIVATE EIQGUADPROG_TRACE_SOLVER)
